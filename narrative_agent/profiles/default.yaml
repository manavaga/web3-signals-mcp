# =============================================================================
# Narrative Agent Profile — v2 (6-source rebuild)
# =============================================================================
# Scores narrative momentum from Reddit, Twitter, Farcaster, CryptoPanic,
# Google News, and CoinGecko Trending.
# Authority weighting, influencer tracking, LLM sentiment pipeline.
# Change any value here — agent logic adapts automatically.
# =============================================================================

name: narrative_default
http_timeout_sec: 20

# ---------------------------------------------------------------------------
# Assets to track
# ---------------------------------------------------------------------------
assets:
  - BTC
  - ETH
  - SOL
  - BNB
  - XRP
  - ADA
  - AVAX
  - DOT
  - MATIC
  - LINK
  - UNI
  - ATOM
  - LTC
  - FIL
  - NEAR
  - APT
  - ARB
  - OP
  - INJ
  - SUI

# ---------------------------------------------------------------------------
# Signal thresholds
# ---------------------------------------------------------------------------
thresholds:
  narrative_score_min: 0.40
  narrative_score_max: 0.70
  peak_window_days: 30

# ---------------------------------------------------------------------------
# Influencer file path (relative to engine.py or absolute)
# ---------------------------------------------------------------------------
influencer_file: ""   # empty = auto-detect data/influencers.yaml

# ---------------------------------------------------------------------------
# Source 1: Reddit (via PRAW) — with authority weighting
# ---------------------------------------------------------------------------
reddit:
  enabled: true
  user_agent: "web3-signal-bot:v1.0 (by /u/Impossible-Ad564)"

  subreddits:
    - CryptoCurrency
    - CryptoMarkets
    - Bitcoin
    - ethereum
    - solana
    - altcoin
    - defi
    - ethdev
    - CryptoTechnology
    - cosmosnetwork

  search_keywords:
    - cryptocurrency
    - crypto
    - defi
    - web3
    - bitcoin
    - ethereum
    - solana
    - altcoin
    - blockchain
    - token
    - staking
    - yield farming
    - airdrop
    - whale alert
    - bull run
    - bear market

  posts_per_search: 250
  time_filter: day
  sort: new
  min_score: 5
  weight_by_score: false   # replaced by authority weighting

  # Authority weighting — weights posts by author credibility
  authority:
    enabled: true
    min_account_age_days: 30        # ignore accounts younger than 30 days
    karma_tiers:
      - min_karma: 0
        weight: 1.0
      - min_karma: 1000
        weight: 1.5
      - min_karma: 10000
        weight: 2.0
      - min_karma: 50000
        weight: 3.0
      - min_karma: 100000
        weight: 4.0
    mod_bonus: 1.5                  # multiplier if author is a moderator
    verified_bonus: 1.2             # multiplier if email verified

# ---------------------------------------------------------------------------
# Source 2: Twitter/X (via twikit — free, no API key)
# ---------------------------------------------------------------------------
twitter:
  enabled: false    # twikit blocked by Cloudflare from server IPs — enable with Twitter API v2 or proxy
  provider: twikit
  # Credentials via env: TWITTER_USERNAME, TWITTER_EMAIL, TWITTER_PASSWORD
  cookie_path: "/tmp/twikit_cookies.json"
  tweets_per_query: 20

  search_queries:
    # High-signal accounts
    - "from:whale_alert OR from:lookonchain OR from:AltcoinGordon"
    - "from:CryptoCapo_ OR from:Pentosh1 OR from:GCRClassic"
    - "from:DegenSpartan OR from:inversebrah OR from:coaborage"
    # General crypto
    - "bitcoin bullish OR bearish"
    - "ethereum bullish OR bearish"
    - "solana bullish OR bearish"
    - "crypto whale OR accumulation"
    - "altcoin season OR altseason"
    - "defi yield OR airdrop"

# ---------------------------------------------------------------------------
# Source 3: Farcaster (via Neynar — 200K credits/month free)
# ---------------------------------------------------------------------------
farcaster:
  enabled: false    # Neynar free tier doesn't include cast search — enable when on paid plan
  base_url: "https://api.neynar.com/v2/farcaster/cast/search"
  # API key via env: NEYNAR_API_KEY
  results_per_query: 25

  search_queries:
    - bitcoin
    - ethereum
    - solana
    - defi
    - web3 crypto
    - onchain
    - airdrop
    - layer2

# ---------------------------------------------------------------------------
# Source 4: CryptoPanic (free API key, community-voted sentiment)
# ---------------------------------------------------------------------------
cryptopanic:
  enabled: false    # Cloudflare blocks API calls from servers — needs workaround
  base_url: "https://cryptopanic.com/api/v1/posts/"
  # API key via env: CRYPTOPANIC_API_KEY
  filter: hot                        # rising, hot, bullish, bearish, important

  # Map our asset symbols to CryptoPanic currency codes (if different)
  currency_map:
    MATIC: "MATIC"
    DOT: "DOT"
    # Most symbols match directly

# ---------------------------------------------------------------------------
# Source 5: Google News RSS (free, unlimited, no API key)
# ---------------------------------------------------------------------------
google_news:
  enabled: true
  base_url: "https://news.google.com/rss/search"
  max_items_per_asset: 20

  # Human-readable search names for better Google results
  asset_search_names:
    BTC: "Bitcoin"
    ETH: "Ethereum"
    SOL: "Solana"
    BNB: "BNB Binance"
    XRP: "XRP Ripple"
    ADA: "Cardano"
    AVAX: "Avalanche AVAX"
    DOT: "Polkadot"
    MATIC: "Polygon MATIC"
    LINK: "Chainlink"
    UNI: "Uniswap"
    ATOM: "Cosmos ATOM"
    LTC: "Litecoin"
    FIL: "Filecoin"
    NEAR: "NEAR Protocol"
    APT: "Aptos"
    ARB: "Arbitrum"
    OP: "Optimism crypto"
    INJ: "Injective"
    SUI: "Sui crypto"

# ---------------------------------------------------------------------------
# Source 6: CoinGecko Trending (free, no key)
# ---------------------------------------------------------------------------
coingecko_trending:
  enabled: true
  base_url: "https://api.coingecko.com/api/v3/search/trending"
  trending_boost: 20

# ---------------------------------------------------------------------------
# Asset keyword mapping — how we detect which asset a post is about
# ---------------------------------------------------------------------------
asset_keywords:
  BTC: [bitcoin, btc, satoshi, digital gold]
  ETH: [ethereum, eth, vitalik, dencun]
  SOL: [solana, sol, solana etf, solana network]
  BNB: [bnb, binance coin, bsc, binance smart chain]
  XRP: [xrp, ripple, garlinghouse]
  ADA: [cardano, ada, hoskinson]
  AVAX: [avalanche, avax]
  DOT: [polkadot, dot, parachain]
  MATIC: [polygon, matic, pol]
  LINK: [chainlink, link, oracle]
  UNI: [uniswap, uni]
  ATOM: [cosmos, atom, ibc]
  LTC: [litecoin, ltc, digital silver]
  FIL: [filecoin, fil, decentralized storage]
  NEAR: [near protocol, near]
  APT: [aptos, apt]
  ARB: [arbitrum, arb, layer 2]
  OP: [optimism, superchain]
  INJ: [injective, inj]
  SUI: [sui, sui network]

# ---------------------------------------------------------------------------
# Keyword-based sentiment (fast, every cycle)
# ---------------------------------------------------------------------------
sentiment:
  positive: [bull, surge, rally, breakout, ath, gain, pump, rise, growth, strong, buy, accumulate, moon, adoption, upgrade, partnership, launch]
  negative: [bear, crash, dump, drop, sell, fear, rekt, collapse, weak, correction, decline, panic, hack, exploit, rug, scam]

# ---------------------------------------------------------------------------
# LLM Sentiment Pipeline (12-hour batch cycle)
# ---------------------------------------------------------------------------
llm_sentiment:
  enabled: true
  model: "claude-haiku-4-5-20251001"
  max_tokens: 2048
  max_age_hours: 24                  # discard LLM results older than 24h
  system_prompt: >
    You are a crypto market sentiment analyst. Analyze headlines for each
    cryptocurrency and provide structured sentiment analysis. Focus on
    identifying dominant narratives, sentiment direction, and confidence.
    Consider what builders, investors, and traders are saying separately.
